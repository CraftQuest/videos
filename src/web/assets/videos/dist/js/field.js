(function(e){function t(t){for(var o,a,s=t[0],l=t[1],d=t[2],c=0,v=[];c<s.length;c++)a=s[c],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&v.push(r[a][0]),r[a]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);u&&u(t);while(v.length)v.shift()();return n.push.apply(n,d||[]),i()}function i(){for(var e,t=0;t<n.length;t++){for(var i=n[t],o=!0,s=1;s<i.length;s++){var l=i[s];0!==r[l]&&(o=!1)}o&&(n.splice(t--,1),e=a(a.s=i[0]))}return e}var o={},r={field:0},n=[];function a(t){if(o[t])return o[t].exports;var i=o[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=e,a.c=o,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(i,o,function(t){return e[t]}.bind(null,o));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="https://localhost:8090/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var d=0;d<s.length;d++)t(s[d]);var u=l;n.push([2,"chunk-vendors"]),i()})({2:function(e,t,i){e.exports=i("347f")},"347f":function(e,t,i){"use strict";i.r(t);i("e260"),i("e6cf"),i("cca6"),i("a79d");var o=i("8bbf"),r=i.n(o),n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"relative"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.videoUrl,expression:"videoUrl"}],staticClass:"text fullwidth",attrs:{name:e.inputName,placeholder:e.t("videos","Enter a video URL from YouTube or Vimeo")},domProps:{value:e.videoUrl},on:{input:[function(t){t.target.composing||(e.videoUrl=t.target.value)},function(t){return e.preview()}]}}),i("a",{staticClass:"absolute top-2.5 right-4 text-xs",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.browse()}}},[e._v(e._s(e.t("videos","Browse videosâ€¦")))])]),e.previewLoading?[i("div",{staticClass:"spinner"})]:[e.previewError?i("p",{staticClass:"error"},[e._v(e._s(e.previewError))]):e._e(),i("preview",{attrs:{previewVideo:e.previewVideo,previewError:e.previewError},on:{playVideo:e.playVideo,removeVideo:function(t){return e.removeVideo()}}})]],2)},a=[],s=i("f7fe"),l=i.n(s),d=i("6955"),u=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.previewVideo&&!e.previewError?i("div",{staticClass:"preview mt-4 flex flex-nowrap items-start"},[i("div",{staticClass:"flex-shrink-0"},[i("div",{staticClass:"videos-thumb relative pt-0"},[i("div",{staticClass:"aspect-w-16 aspect-h-9 w-44"},[i("img",{staticClass:"w-44",attrs:{src:e.previewVideo.thumbnail,alt:e.previewVideo.title}})]),i("div",{staticClass:"duration"},[e._v(" "+e._s(e.previewVideo.duration)+" ")]),i("div",{staticClass:"play",on:{click:function(t){return e.$emit("playVideo",e.previewVideo)}}})])]),i("div",{staticClass:"ml-2 flex-shrink max-w-sm min-w-0"},[i("div",{staticClass:"line-clamp-2"},[i("strong",[e._v(e._s(e.previewVideo.title))])]),i("ul",[i("li",{staticClass:"truncate block"},[i("a",{attrs:{href:e.previewVideo.url}},[e._v(e._s(e.previewVideo.url))])]),i("li",{staticClass:"truncate block"},[i("a",{staticClass:"light",attrs:{"h:ref":"previewVideo.authorUrl"}},[e._v(e._s(e.previewVideo.authorName))])]),i("li",{staticClass:"truncate block"},[e._v(" "+e._s(e.t("videos","{plays} plays",{plays:e.previewVideo.plays}))+" ")]),i("li",{staticClass:"truncate block"},[i("a",{on:{click:function(t){return t.preventDefault(),e.$emit("removeVideo")}}},[e._v(e._s(e.t("videos","Remove")))])])])])]):e._e()},c=[],v={props:{previewVideo:{type:Object,default:null},previewError:{type:String,default:""}}},p=v,f=i("2877"),h=Object(f["a"])(p,u,c,!1,null,null,null),w=h.exports,V={components:{Preview:w},data:function(){return{eventBus:new r.a,previewVideo:null,previewLoading:!1,previewError:null,videoSelectorModal:null,playerModal:null,fieldVariables:null}},computed:{videoUrl:{get:function(){return this.$store.state.videoUrl},set:function(e){this.$store.commit("updateVideoUrl",e)}},inputName:function(){return this.fieldVariables?this.fieldVariables.namespaceName:null}},methods:{browse:function(){var e=this,t=$('<div class="videoselectormodal modal elementselectormodal"></div>').appendTo(Garnish.$bod),i=$('<div class="new-explorer-container"/>').appendTo(t),o=$('<div class="footer"/>').appendTo(t),r=$("<div/>").appendTo(o);this.videoSelectorModal=new Garnish.Modal(t,{visible:!1,resizable:!1}),this.$nextTick((function(){var t={store:e.$store,data:{eventBus:e.eventBus}};new VideoExplorerConstructor(t).$mount(i.get(0)),new VideoSelectorActionsConstructor(t).$mount(r.get(0))}))},preview:l()((function(){var e=this;if(!this.videoUrl)return this.previewLoading=!1,this.previewVideo=null,this.previewError=null,null;this.previewLoading=!0,this.previewError=null,d["a"].getVideo(this.videoUrl).then((function(t){t.data.error&&(e.previewLoading=!1,e.previewVideo=null,e.previewError=t.data.error),e.previewLoading=!1,e.previewVideo=t.data}))}),1e3),playVideo:function(e){this.eventBus.$emit("playVideo",{video:e})},removeVideo:function(){this.videoUrl=null,this.previewVideo=null}},mounted:function(){var e=this;this.eventBus.$on("useSelectedVideo",(function(){e.videoSelectorModal.hide(),e.preview()})),this.eventBus.$on("cancel",(function(){e.videoSelectorModal.hide()})),this.eventBus.$on("playVideo",(function(t){var i=t.video;e.videoSelectorModal&&e.videoSelectorModal.hide();var o=$('<div class="videos-player-modal modal"></div>').appendTo(Garnish.$bod),r={data:function(){return{eventBus:this.eventBus,video:i}}};e.playerModal=new VideoPlayerConstructor(r).$mount(o.get(0)),e.playerModal.$children[0].$on("hide",(function(){e.videoSelectorModal&&e.videoSelectorModal.show(),e.playerModal.$destroy(),e.playerModal=null}))})),this.$root.fieldVariables&&(this.fieldVariables=this.$root.fieldVariables,this.fieldVariables.value&&(this.$store.commit("updateVideoUrl",this.fieldVariables.value.url),this.previewVideo=this.fieldVariables.value))}},m=V,g=Object(f["a"])(m,n,a,!1,null,null,null),b=g.exports,y=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"buttons right"},[i("div",{staticClass:"btn",on:{click:function(t){return e.cancel()}}},[e._v(e._s(e.t("videos","Cancel")))]),i("div",{staticClass:"btn submit",class:{disabled:!e.hasSelectedVideo},on:{click:function(t){return e.useSelectedVideo()}}},[e._v(e._s(e.t("videos","Select")))])])])},C=[],S=i("5530"),_=i("5880"),x=i.n(_),k={computed:{hasSelectedVideo:function(){return this.$store.state.selectedVideo}},methods:Object(S["a"])(Object(S["a"])({},Object(_["mapActions"])(["updateVideoUrlWithSelectedVideo"])),{},{useSelectedVideo:function(){this.updateVideoUrlWithSelectedVideo(),this.$root.eventBus.$emit("useSelectedVideo")},cancel:function(){this.$root.eventBus.$emit("cancel")}})},U=k,M=Object(f["a"])(U,y,C,!1,null,null,null),T=M.exports,E=i("a3a0"),O=i("9675"),j=i.n(O);r.a.use(x.a);var G=function(e){return new x.a.Store(j()(e))},L=i("ab54");r.a.config.productionTip=!1,r.a.mixin(L["a"]),window.VideoFieldConstructor=r.a.extend({render:function(e){return e(b)},created:function(){this.$store=G(E["a"])}}),window.VideoSelectorActionsConstructor=r.a.extend({render:function(e){return e(T)}})},5880:function(e,t){e.exports=Vuex},6955:function(e,t,i){"use strict";var o=i("cebe"),r=i.n(o);t["a"]={getGateways:function(){return r.a.get(Craft.getActionUrl("videos/vue/get-gateways"),{headers:{"X-CSRF-Token":Craft.csrfTokenValue}})},getVideos:function(e,t,i){var o={gateway:e,method:t};return i&&(o.options=i),r.a.post(Craft.getActionUrl("videos/vue/get-videos"),o,{headers:{"X-CSRF-Token":Craft.csrfTokenValue}})},getVideo:function(e){var t={url:e};return r.a.post(Craft.getActionUrl("videos/vue/get-video"),t,{headers:{"X-CSRF-Token":Craft.csrfTokenValue}})},getVideoEmbedHtml:function(e){var t={gateway:e.gatewayHandle,videoId:e.id};return r.a.post(Craft.getActionUrl("videos/vue/get-video-embed-html"),t,{headers:{"X-CSRF-Token":Craft.csrfTokenValue}})}}},"8bbf":function(e,t){e.exports=Vue},a3a0:function(e,t,i){"use strict";i("7db0");var o=i("6955");t["a"]={strict:!0,state:{videosLoading:!1,gateways:[],currentGatewayHandle:null,selectedCollection:null,selectedVideo:null,playingVideo:null,videos:[],videoUrl:null},getters:{currentGateway:function(e){return e?e.gateways.find((function(t){return t.handle===e.currentGatewayHandle})):null}},actions:{displayError:function(e,t){Craft.cp.displayError(t)},displayNotice:function(e,t){Craft.cp.displayNotice(t)},getGateways:function(e){var t=e.commit;return o["a"].getGateways().then((function(e){t("updateGateways",e)}))},getVideos:function(e,t){var i=e.commit,r=t.gateway,n=t.method,a=t.options;return i("updateVideosLoading",!0),o["a"].getVideos(r,n,a).then((function(e){i("updateVideosLoading",!1),i("updateVideos",{videos:e.data.videos,videosMore:e.data.videosMore,videosToken:e.data.videosToken})})).catch((function(e){throw i("updateVideosLoading",!1),i("updateVideos",{videos:[],videosMore:null,videosToken:null}),e}))},selectVideo:function(e,t){var i=e.commit;i("updateSelectedVideo",t)},updateVideoUrlWithSelectedVideo:function(e){var t=e.commit,i=e.state;if(!i.selectedVideo)return!1;t("updateVideoUrl",i.selectedVideo.url)}},mutations:{updateVideos:function(e,t){var i=t.videos,o=t.videosMore,r=t.videosToken;e.videos=i,e.videosMore=o,e.videosToken=r},updateGateways:function(e,t){e.gateways=t.data},updateCurrentGatewayHandle:function(e,t){e.currentGatewayHandle=t},updateVideosLoading:function(e,t){e.videosLoading=t},updateSelectedCollection:function(e,t){e.selectedCollection=t},updateSelectedVideo:function(e,t){e.selectedVideo=t},updatePlayingVideo:function(e,t){e.playingVideo=t},updateVideoUrl:function(e,t){e.videoUrl=t}}}},ab54:function(e,t,i){"use strict";t["a"]={methods:{getCollectionUniqueKey:function(e,t,i){return e+":"+t+":"+i},t:function(e,t,i){return Craft.t(e,t,i)}}}},cebe:function(e,t){e.exports=axios}});
//# sourceMappingURL=field.js.map