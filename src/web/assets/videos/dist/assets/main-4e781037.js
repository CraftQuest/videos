const W={methods:{getCollectionUniqueKey(t,e,r){return t+":"+e+":"+r},t(t,e,r){return Craft.t(t,e,r)}}};var b=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function E(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var z=Object.prototype.toString,B=function(e){if(e===void 0)return"undefined";if(e===null)return"null";var r=typeof e;if(r==="boolean")return"boolean";if(r==="string")return"string";if(r==="number")return"number";if(r==="symbol")return"symbol";if(r==="function")return Z(e)?"generatorfunction":"function";if(X(e))return"array";if(te(e))return"buffer";if(ee(e))return"arguments";if(Y(e))return"date";if(J(e))return"error";if(Q(e))return"regexp";switch(R(e)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(K(e))return"generator";switch(r=z.call(e),r){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return r.slice(8,-1).toLowerCase().replace(/\s/g,"")};function R(t){return typeof t.constructor=="function"?t.constructor.name:null}function X(t){return Array.isArray?Array.isArray(t):t instanceof Array}function J(t){return t instanceof Error||typeof t.message=="string"&&t.constructor&&typeof t.constructor.stackTraceLimit=="number"}function Y(t){return t instanceof Date?!0:typeof t.toDateString=="function"&&typeof t.getDate=="function"&&typeof t.setDate=="function"}function Q(t){return t instanceof RegExp?!0:typeof t.flags=="string"&&typeof t.ignoreCase=="boolean"&&typeof t.multiline=="boolean"&&typeof t.global=="boolean"}function Z(t,e){return R(t)==="GeneratorFunction"}function K(t){return typeof t.throw=="function"&&typeof t.return=="function"&&typeof t.next=="function"}function ee(t){try{if(typeof t.length=="number"&&typeof t.callee=="function")return!0}catch(e){if(e.message.indexOf("callee")!==-1)return!0}return!1}function te(t){return t.constructor&&typeof t.constructor.isBuffer=="function"?t.constructor.isBuffer(t):!1}/*!
 * shallow-clone <https://github.com/jonschlinkert/shallow-clone>
 *
 * Copyright (c) 2015-present, Jon Schlinkert.
 * Released under the MIT License.
 */const G=Symbol.prototype.valueOf,re=B;function ne(t,e){switch(re(t)){case"array":return t.slice();case"object":return Object.assign({},t);case"date":return new t.constructor(Number(t));case"map":return new Map(t);case"set":return new Set(t);case"buffer":return ae(t);case"symbol":return le(t);case"arraybuffer":return ie(t);case"float32array":case"float64array":case"int16array":case"int32array":case"int8array":case"uint16array":case"uint32array":case"uint8clampedarray":case"uint8array":return se(t);case"regexp":return oe(t);case"error":return Object.create(t);default:return t}}function oe(t){const e=t.flags!==void 0?t.flags:/\w+$/.exec(t)||void 0,r=new t.constructor(t.source,e);return r.lastIndex=t.lastIndex,r}function ie(t){const e=new t.constructor(t.byteLength);return new Uint8Array(e).set(new Uint8Array(t)),e}function se(t,e){return new t.constructor(t.buffer,t.byteOffset,t.length)}function ae(t){const e=t.length,r=Buffer.allocUnsafe?Buffer.allocUnsafe(e):Buffer.from(e);return t.copy(r),r}function le(t){return G?Object(G.call(t)):{}}var de=ne;/*!
 * isobject <https://github.com/jonschlinkert/isobject>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var ce=function(e){return e!=null&&typeof e=="object"&&Array.isArray(e)===!1};/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var ue=ce;function A(t){return ue(t)===!0&&Object.prototype.toString.call(t)==="[object Object]"}var fe=function(e){var r,n;return!(A(e)===!1||(r=e.constructor,typeof r!="function")||(n=r.prototype,A(n)===!1)||n.hasOwnProperty("isPrototypeOf")===!1)};const ve=de,pe=B,he=fe;function M(t,e){switch(pe(t)){case"object":return me(t,e);case"array":return _e(t,e);default:return ve(t)}}function me(t,e){if(typeof e=="function")return e(t);if(e||he(t)){const r=new t.constructor;for(let n in t)r[n]=M(t[n],e);return r}return t}function _e(t,e){const r=new t.constructor(t.length);for(let n=0;n<t.length;n++)r[n]=M(t[n],e);return r}var ye=M;const we=E(ye),V=window.axios,C={getGateways(){return V.get(Craft.getActionUrl("videos/explorer/get-gateways"),{headers:{"X-CSRF-Token":Craft.csrfTokenValue}})},getVideos(t,e,r){const n={gateway:t,method:e};return r&&(n.options=r),V.post(Craft.getActionUrl("videos/explorer/get-videos"),n,{headers:{"X-CSRF-Token":Craft.csrfTokenValue}})},getVideo(t){const e={url:t};return V.post(Craft.getActionUrl("videos/explorer/get-video"),e,{headers:{"X-CSRF-Token":Craft.csrfTokenValue}})},getVideoEmbedHtml(t){const e={gateway:t.gatewayHandle,videoId:t.id};return V.post(Craft.getActionUrl("videos/explorer/get-video-embed-html"),e,{headers:{"X-CSRF-Token":Craft.csrfTokenValue}})}},ge={strict:!0,state:{currentGatewayHandle:null,gateways:[],playingVideo:null,selectedCollection:null,selectedVideo:null,videoUrl:null,videos:[],videosGateway:null,videosLoading:!1,videosMethod:null,videosMoreToken:null,videosOptions:null},getters:{currentGateway(t){return t?t.gateways.find(e=>e.handle===t.currentGatewayHandle):null}},actions:{displayError(t,e){Craft.cp.displayError(e)},displayNotice(t,e){Craft.cp.displayNotice(e)},getGateways({commit:t}){return C.getGateways().then(e=>{t("updateGateways",e)})},getVideos({commit:t,state:e},{gateway:r,method:n,options:o,append:i}){return C.getVideos(r,n,o).then(s=>{let l;i===!0?l=[...e.videos,...s.data.videos]:l=s.data.videos,t("updateVideos",{videos:l,videosGateway:r,videosMethod:n,videosOptions:o,videosMoreToken:s.data.moreToken})}).catch(s=>{throw t("updateVideos",{videos:[],videosMoreToken:null}),s})},selectVideo({commit:t},e){t("updateSelectedVideo",e)},updateVideoUrlWithSelectedVideo({commit:t,state:e}){if(!e.selectedVideo)return!1;t("updateVideoUrl",e.selectedVideo.url)}},mutations:{updateCurrentGatewayHandle(t,e){t.currentGatewayHandle=e},updateGateways(t,e){t.gateways=e.data},updatePlayingVideo(t,e){t.playingVideo=e},updateSelectedCollection(t,e){t.selectedCollection=e},updateSelectedVideo(t,e){t.selectedVideo=e},updateVideos(t,{videos:e,videosGateway:r,videosMethod:n,videosOptions:o,videosMoreToken:i}){t.videos=e,t.videosGateway=r,t.videosMethod=n,t.videosOptions=o,t.videosMoreToken=i},updateVideosLoading(t,e){t.videosLoading=e},updateVideoUrl(t,e){t.videoUrl=e}}},$e=window.Vue,F=window.Vuex;$e.use(F);const H=()=>new F.Store(we(ge));function c(t,e,r,n,o,i,s,l){var a=typeof t=="function"?t.options:t;e&&(a.render=e,a.staticRenderFns=r,a._compiled=!0),n&&(a.functional=!0),i&&(a._scopeId="data-v-"+i);var u;if(s?(u=function(f){f=f||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!f&&typeof __VUE_SSR_CONTEXT__<"u"&&(f=__VUE_SSR_CONTEXT__),o&&o.call(this,f),f&&f._registeredComponents&&f._registeredComponents.add(s)},a._ssrRegister=u):o&&(u=l?function(){o.call(this,(a.functional?this.parent:this).$root.$options.shadowRoot)}:o),u)if(a.functional){a._injectStyles=u;var y=a.render;a.render=function(m,w){return u.call(w),y(m,w)}}else{var v=a.beforeCreate;a.beforeCreate=v?[].concat(v,u):[u]}return{exports:t,options:a}}const be={};var Ve=function(){var e=this,r=e._self._c;return r("svg",{staticClass:"h-6 w-6",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[r("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5"}})])},Ce=[],ke=c(be,Ve,Ce,!1,null,null,null,null);const xe=ke.exports,Se={};var Me=function(){var e=this,r=e._self._c;return r("svg",{staticClass:"h-6 w-6",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[r("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"}})])},Oe=[],Te=c(Se,Me,Oe,!1,null,null,null,null);const je=Te.exports,Ge={};var Ae=function(){var e=this,r=e._self._c;return r("svg",{staticClass:"h-6 w-6",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[r("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"}})])},Le=[],Ue=c(Ge,Ae,Le,!1,null,null,null,null);const Ee=Ue.exports,Be={};var Re=function(){var e=this,r=e._self._c;return r("svg",{staticClass:"h-6 w-6",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[r("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"}})])},Fe=[],He=c(Be,Re,Fe,!1,null,null,null,null);const Ie=He.exports,Pe={};var Ne=function(){var e=this,r=e._self._c;return r("svg",{staticClass:"h-6 w-6",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[r("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"}})])},De=[],qe=c(Pe,Ne,De,!1,null,null,null,null);const We=qe.exports;const ze=window.Vuex.mapState,Xe=window.Vuex.mapGetters,Je={components:{ThumbUp:xe,Folder:je,Layout:Ee,VideoCamera:Ie,List:We},computed:{...ze({gateways:t=>t.gateways,selectedCollection:t=>t.selectedCollection}),...Xe(["currentGateway"]),currentGatewayHandle:{get(){return this.$store.state.currentGatewayHandle},set(t){this.$store.commit("updateCurrentGatewayHandle",t)}}},methods:{handleCollectionClick(t,e,r){const n=this.getCollectionUniqueKey(this.currentGatewayHandle,t,e);this.$store.commit("updateSelectedCollection",n),this.$store.commit("updateVideosLoading",!0),this.$store.dispatch("getVideos",{gateway:this.currentGatewayHandle,method:r.method,options:r.options}).then(()=>{this.$store.commit("updateVideosLoading",!1)}).catch(()=>{this.$store.commit("updateVideosLoading",!1),this.$store.dispatch("displayError","Couldn’t get videos.")})},isCollectionSelected(t,e){return this.selectedCollection===this.getCollectionUniqueKey(this.currentGatewayHandle,t,e)}}};var Ye=function(){var e=this,r=e._self._c;return r("div",{staticClass:"sidebar"},[r("div",{staticClass:"dv-px-2"},[r("div",{staticClass:"select fullwidth"},[r("select",{directives:[{name:"model",rawName:"v-model",value:e.currentGatewayHandle,expression:"currentGatewayHandle"}],on:{change:function(n){var o=Array.prototype.filter.call(n.target.options,function(i){return i.selected}).map(function(i){var s="_value"in i?i._value:i.value;return s});e.currentGatewayHandle=n.target.multiple?o:o[0]}}},e._l(e.gateways,function(n,o){return r("option",{key:`gateway-${o}`,domProps:{value:n.handle}},[e._v(" "+e._s(n.name)+" ")])}),0)])]),r("nav",{staticClass:"dv-mt-4"},[r("ul",[e.currentGateway?[e._l(e.currentGateway.sections,function(n,o){return[r("li",{key:`section-${o}`,staticClass:"heading !dv-mb-1"},[r("span",[e._v(e._s(n.name))])]),e._l(n.collections,function(i,s){return[r("li",{key:`collection-${o}-${s}`},[r("a",{class:{sel:e.isCollectionSelected(o,s)},attrs:{href:"#"},on:{click:function(l){return l.preventDefault(),e.handleCollectionClick(o,s,i)}}},[i.icon?[r(i.icon,{tag:"component",staticClass:"dv-text-blue-500 dv-w-5 dv-h-5 dv-mr-2"})]:e._e(),e._v(" "+e._s(i.name)+" ")],2)])]})]})]:e._e()],2)])])},Qe=[],Ze=c(Je,Ye,Qe,!1,null,"33348c44",null,null);const Ke=Ze.exports;var et="Expected a function",L=0/0,tt="[object Symbol]",rt=/^\s+|\s+$/g,nt=/^[-+]0x[0-9a-f]+$/i,ot=/^0b[01]+$/i,it=/^0o[0-7]+$/i,st=parseInt,at=typeof b=="object"&&b&&b.Object===Object&&b,lt=typeof self=="object"&&self&&self.Object===Object&&self,dt=at||lt||Function("return this")(),ct=Object.prototype,ut=ct.toString,ft=Math.max,vt=Math.min,x=function(){return dt.Date.now()};function pt(t,e,r){var n,o,i,s,l,a,u=0,y=!1,v=!1,f=!0;if(typeof t!="function")throw new TypeError(et);e=U(e)||0,S(r)&&(y=!!r.leading,v="maxWait"in r,i=v?ft(U(r.maxWait)||0,e):i,f="trailing"in r?!!r.trailing:f);function m(d){var p=n,_=o;return n=o=void 0,u=d,s=t.apply(_,p),s}function w(d){return u=d,l=setTimeout(g,e),y?m(d):s}function N(d){var p=d-a,_=d-u,j=e-p;return v?vt(j,i-_):j}function O(d){var p=d-a,_=d-u;return a===void 0||p>=e||p<0||v&&_>=i}function g(){var d=x();if(O(d))return T(d);l=setTimeout(g,N(d))}function T(d){return l=void 0,f&&n?m(d):(n=o=void 0,s)}function D(){l!==void 0&&clearTimeout(l),u=0,n=a=o=l=void 0}function q(){return l===void 0?s:T(x())}function k(){var d=x(),p=O(d);if(n=arguments,o=this,a=d,p){if(l===void 0)return w(a);if(v)return l=setTimeout(g,e),m(a)}return l===void 0&&(l=setTimeout(g,e)),s}return k.cancel=D,k.flush=q,k}function S(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function ht(t){return!!t&&typeof t=="object"}function mt(t){return typeof t=="symbol"||ht(t)&&ut.call(t)==tt}function U(t){if(typeof t=="number")return t;if(mt(t))return L;if(S(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=S(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(rt,"");var r=ot.test(t);return r||it.test(t)?st(t.slice(2),r?2:8):nt.test(t)?L:+t}var _t=pt;const I=E(_t),yt=window.Vuex.mapGetters,wt={data(){return{query:""}},computed:{...yt(["currentGateway"]),debouncedSearch(){return I(()=>{this.search()},1e3)}},methods:{search(){this.debouncedSearch.cancel(),this.$store.commit("updateSelectedCollection",null),this.$store.commit("updateVideosLoading",!0),this.$store.dispatch("getVideos",{gateway:this.currentGateway.handle,method:"search",options:{q:this.query}}).then(()=>{this.$store.commit("updateVideosLoading",!1)}).catch(()=>{this.$store.commit("updateVideosLoading",!1),this.$store.dispatch("displayError","Couldn’t get videos.")})}}};var gt=function(){var e=this,r=e._self._c;return e.currentGateway?r("div",[r("input",{directives:[{name:"model",rawName:"v-model",value:e.query,expression:"query"}],staticClass:"text fullwidth",attrs:{type:"search",placeholder:e.t("videos","Search {gateway} videos…",{gateway:e.currentGateway.name})},domProps:{value:e.query},on:{input:[function(n){n.target.composing||(e.query=n.target.value)},e.debouncedSearch],keyup:function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"enter",13,n.key,"Enter")?null:e.search.apply(null,arguments)}}})]):e._e()},$t=[],bt=c(wt,gt,$t,!1,null,null,null,null);const Vt=bt.exports,Ct={};var kt=function(){var e=this,r=e._self._c;return r("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",height:"16",width:"12",viewBox:"0 0 384 512",fill:"currentColor"}},[r("path",{attrs:{d:"M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"}})])},xt=[],St=c(Ct,kt,xt,!1,null,null,null,null);const Mt=St.exports,Ot={components:{PlayIcon:Mt},props:{url:{type:String,default:null},duration:{type:String,default:null},selected:{type:Boolean,default:!1}}};var Tt=function(){var e=this,r=e._self._c;return r("div",{staticClass:"videos-thumb",class:{"dv-ring dv-ring-red-500 dv-ring-opacity-80":e.selected}},[r("div",{staticClass:"videos-thumb-image-container"},[r("div",{staticClass:"videos-thumb-image",style:"background-image: url("+e.url+")"})]),r("div",{staticClass:"duration"},[e._v(" "+e._s(e.duration)+" ")]),r("div",{staticClass:"play",on:{click:function(n){return n.preventDefault(),e.$emit("playVideo")}}},[r("PlayIcon")],1)])},jt=[],Gt=c(Ot,Tt,jt,!1,null,null,null,null);const P=Gt.exports,At=window.Vuex.mapActions,Lt={components:{Thumb:P},props:{video:{type:Object,required:!0}},computed:{isVideoSelected(){return this.$store.state.selectedVideo?this.$store.state.selectedVideo.id===this.video.id:!1}},methods:{...At(["selectVideo","updateVideoUrlWithSelectedVideo"]),play(t){this.$root.eventBus.$emit("playVideo",{video:t})},useVideo(t){this.selectVideo(t),this.updateVideoUrlWithSelectedVideo(),this.$root.eventBus.$emit("useSelectedVideo")}}};var Ut=function(){var e=this,r=e._self._c;return r("div",{staticClass:"dv-group",on:{click:function(n){return e.selectVideo(e.video)},dblclick:function(n){return e.useVideo(e.video)}}},[r("thumb",{attrs:{selected:e.isVideoSelected,url:e.video.thumbnail,duration:e.video.duration},on:{playVideo:function(n){return e.play(e.video)}}}),r("div",{staticClass:"dv-mt-2 dv-flex dv-flex-row dv-flex-nowrap dv-items-center"},[e.video.private?[r("svg",{staticClass:"dv-h-4 dv-w-4 dv-mr-1",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}},[r("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"}})])]:e._e(),r("div",{staticClass:"dv-flex-1"},[r("div",{staticClass:"dv-line-clamp-2"},[e._v(" "+e._s(e.video.title)+" ")])])],2)],1)},Et=[],Bt=c(Lt,Ut,Et,!1,null,null,null,null);const Rt=Bt.exports,Ft={components:{VideoCard:Rt},props:{videos:{type:Array,required:!0}}};var Ht=function(){var e=this,r=e._self._c;return r("div",{staticClass:"dv-w-full dv-grid dv-grid-cols-3 dv-grid dv-gap-4"},[e._l(e.videos,function(n,o){return[r("video-card",{key:`video-${o}`,attrs:{video:n}})]})],2)},It=[],Pt=c(Ft,Ht,It,!1,null,null,null,null);const Nt=Pt.exports,Dt=window.Vuex.mapState,qt={name:"VideosApp",components:{Sidebar:Ke,Search:Vt,Videos:Nt},data(){return{loading:!1,loadingMore:!1}},computed:{...Dt({gateways:t=>t.gateways,videos:t=>t.videos,videosGateway:t=>t.videosGateway,videosMethod:t=>t.videosMethod,videosOptions:t=>t.videosOptions,videosMoreToken:t=>t.videosMoreToken,videosLoading:t=>t.videosLoading})},mounted(){this.loading=!0,this.$store.dispatch("getGateways").then(()=>{if(this.loading=!1,this.gateways.length>0){const t=this.gateways[0];this.$store.commit("updateCurrentGatewayHandle",t.handle);const e=t.sections[0].collections[0],r=this.getCollectionUniqueKey(t.handle,0,0);this.$store.commit("updateSelectedCollection",r),this.$store.commit("updateVideosLoading",!0),this.$store.dispatch("getVideos",{gateway:t.handle,method:e.method,options:e.options}).then(()=>{this.$store.commit("updateVideosLoading",!1)}).catch(()=>{this.$store.commit("updateVideosLoading",!1),this.$store.dispatch("displayError","Couldn’t get videos.")})}})},methods:{loadMore(){if(this.loadingMore)return;const t=this.videosOptions?JSON.parse(JSON.stringify(this.videosOptions)):{};t.moreToken=this.videosMoreToken,this.loadingMore=!0,this.$store.dispatch("getVideos",{gateway:this.videosGateway,method:this.videosMethod,options:t,append:!0}).then(()=>{this.loadingMore=!1}).catch(()=>{this.$store.dispatch("displayError","Couldn’t get videos."),this.loadingMore=!1})},onScroll(){this.maybeLoadMore()},maybeLoadMore(){if(!this.videosMoreToken||!this.canLoadMore())return!1;this.loadMore()},canLoadMore(){const t=this.$refs.main.scrollHeight,e=this.$refs.main.scrollTop,r=this.$refs.main.clientHeight;return t-e<=r+15}}};var Wt=function(){var e=this,r=e._self._c;return r("div",{staticClass:"dv-h-full",attrs:{id:"videos"}},[r("div",{staticClass:"body",class:{"has-sidebar":!e.loading,"dv-flex dv-justify-center":e.loading}},[r("div",{class:{"content has-sidebar":!e.loading,"":e.loading}},[e.loading?[r("div",{staticClass:"spinner"})]:[r("sidebar"),r("div",{ref:"main",staticClass:"main",on:{scroll:e.onScroll}},[r("search",{staticClass:"dv-mb-6"}),e.videosLoading?[r("div",{staticClass:"spinner"})]:[r("videos",{attrs:{videos:e.videos}}),e.videosMoreToken?r("div",[e.loadingMore?[r("div",{staticClass:"spinner"})]:[r("button",{staticClass:"btn",on:{click:function(n){return e.loadMore()}}},[e._v(" Load More ")])]],2):e._e()]],2)]],2)])])},zt=[],Xt=c(qt,Wt,zt,!1,null,null,null,null);const Jt=Xt.exports;const Yt={data(){return{modal:null,embed:null}},mounted(){const t=this.$root.video;C.getVideoEmbedHtml(t).then(e=>{this.embed=e.data.html}),this.modal=new Garnish.Modal(this.$refs.modal,{resizable:!1,onHide:(function(){this.$emit("hide")}).bind(this)})},destroyed(){this.modal.$shade[0].remove(),this.$el.remove()}};var Qt=function(){var e=this,r=e._self._c;return r("div",{ref:"modal",staticClass:"videos-player-modal modal"},[r("div",{staticClass:"videos-player dv-bg-black dv-h-full"},[r("div",{domProps:{innerHTML:e._s(e.embed)}})])])},Zt=[],Kt=c(Yt,Qt,Zt,!1,null,null,null,null);const er=Kt.exports,tr={components:{Thumb:P},props:{previewVideo:{type:Object,default:null},previewError:{type:String,default:""}}};var rr=function(){var e=this,r=e._self._c;return e.previewVideo?r("div",[e.previewVideo.hasErrors?[r("ul",{staticClass:"errors padded"},[e._l(e.previewVideo.errors,function(n,o){return[e._l(n,function(i,s){return[r("li",{key:o+" :"+s},[e._v(" "+e._s(i)+" ")])]})]})],2)]:[r("div",{staticClass:"preview dv-flex dv-flex-nowrap dv-items-start"},[r("div",{staticClass:"dv-shrink-0"},[r("thumb",{staticClass:"dv-pt-0 dv-w-44",attrs:{url:e.previewVideo.thumbnail,duration:e.previewVideo.duration},on:{playVideo:function(n){return e.$emit("playVideo",e.previewVideo)}}})],1),r("div",{staticClass:"dv-ml-2 dv-shrink dv-max-w-sm dv-min-w-0"},[r("div",{staticClass:"dv-line-clamp-2"},[r("strong",[e._v(e._s(e.previewVideo.title))])]),r("ul",[r("li",{staticClass:"truncate dv-block"},[r("a",{attrs:{href:e.previewVideo.url}},[e._v(e._s(e.previewVideo.url))])]),r("li",{staticClass:"truncate dv-block"},[r("a",{staticClass:"light",attrs:{href:e.previewVideo.authorUrl}},[e._v(e._s(e.previewVideo.authorName))])]),r("li",{staticClass:"truncate dv-block"},[e._v(" "+e._s(e.t("videos","{plays} plays",{plays:e.previewVideo.plays}))+" ")]),r("li",{staticClass:"truncate dv-block"},[r("a",{on:{click:function(n){return n.preventDefault(),e.$emit("removeVideo")}}},[e._v(" "+e._s(e.t("videos","Remove"))+" ")])])])])])]],2):e._e()},nr=[],or=c(tr,rr,nr,!1,null,null,null,null);const ir=or.exports,sr=window.Vue,ar={components:{Preview:ir},data(){return{eventBus:new sr,previewVideo:null,previewLoading:!1,previewError:null,videoSelectorModal:null,playerModal:null,fieldVariables:null}},computed:{videoUrl:{get(){return this.$store.state.videoUrl},set(t){this.$store.commit("updateVideoUrl",t)}},inputName(){return this.fieldVariables?this.fieldVariables.namespaceName:null}},mounted(){this.eventBus.$on("useSelectedVideo",()=>{this.videoSelectorModal.hide(),this.preview()}),this.eventBus.$on("cancel",()=>{this.videoSelectorModal.hide()}),this.eventBus.$on("playVideo",({video:t})=>{this.videoSelectorModal&&this.videoSelectorModal.hide();const e=$('<div class="videos-player-modal modal"></div>').appendTo(Garnish.$bod),r={data:function(){return{eventBus:this.eventBus,video:t}}};this.playerModal=new VideoPlayerConstructor(r).$mount(e.get(0)),this.playerModal.$children[0].$on("hide",()=>{this.videoSelectorModal&&this.videoSelectorModal.show(),this.playerModal.$destroy(),this.playerModal=null})}),this.$root.fieldVariables&&(this.fieldVariables=this.$root.fieldVariables,this.fieldVariables.value&&(this.$store.commit("updateVideoUrl",this.fieldVariables.value.url),this.previewVideo=this.fieldVariables.value))},methods:{browse(){const t=$('<div class="videoselectormodal modal elementselectormodal"></div>').appendTo(Garnish.$bod),e=$('<div class="new-explorer-container"/>').appendTo(t),r=$('<div class="footer"/>').appendTo(t),n=$("<div/>").appendTo(r);this.videoSelectorModal=new Garnish.Modal(t,{visible:!1,resizable:!1}),this.$nextTick(()=>{const o={store:this.$store,data:{eventBus:this.eventBus}};new VideoExplorerConstructor(o).$mount(e.get(0)),new VideoSelectorActionsConstructor(o).$mount(n.get(0))})},preview:I(function(){if(!this.videoUrl)return this.previewLoading=!1,this.previewVideo=null,this.previewError=null,null;this.previewLoading=!0,this.previewError=null,C.getVideo(this.videoUrl).then(t=>{this.previewLoading=!1,t.data.error?(this.previewVideo=null,this.previewError=t.data.error):this.previewVideo=t.data})},1e3),playVideo(t){this.eventBus.$emit("playVideo",{video:t})},removeVideo(){this.videoUrl=null,this.previewVideo=null}}};var lr=function(){var e=this,r=e._self._c;return r("div",[r("div",{staticClass:"dv-relative"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.videoUrl,expression:"videoUrl"}],staticClass:"text fullwidth",attrs:{name:e.inputName,placeholder:e.t("videos","Enter a video URL from YouTube or Vimeo")},domProps:{value:e.videoUrl},on:{input:[function(n){n.target.composing||(e.videoUrl=n.target.value)},function(n){return e.preview()}]}}),r("button",{staticClass:"dv-absolute dv-top-2.5 dv-right-4 dv-text-xs dv-text-[#0b69a3] hover:dv-underline dv-cursor-pointer",on:{click:function(n){return n.preventDefault(),e.browse()}}},[e._v(" "+e._s(e.t("videos","Browse videos…"))+" ")])]),e.previewLoading?[r("div",{staticClass:"spinner dv-mt-2"})]:[e.previewError?r("div",{staticClass:"dv-mt-4"},[r("ul",{staticClass:"errors padded"},[r("li",[e._v(e._s(e.previewError))])])]):e._e(),r("preview",{staticClass:"dv-mt-4",attrs:{"preview-video":e.previewVideo,"preview-error":e.previewError},on:{playVideo:e.playVideo,removeVideo:function(n){return e.removeVideo()}}})]],2)},dr=[],cr=c(ar,lr,dr,!1,null,null,null,null);const ur=cr.exports,fr=window.Vuex.mapActions,vr={computed:{hasSelectedVideo(){return this.$store.state.selectedVideo}},methods:{...fr(["updateVideoUrlWithSelectedVideo"]),useSelectedVideo(){this.updateVideoUrlWithSelectedVideo(),this.$root.eventBus.$emit("useSelectedVideo")},cancel(){this.$root.eventBus.$emit("cancel")}}};var pr=function(){var e=this,r=e._self._c;return r("div",[r("div",{staticClass:"buttons dv-float-right"},[r("div",{staticClass:"btn",on:{click:function(n){return e.cancel()}}},[e._v(" "+e._s(e.t("videos","Cancel"))+" ")]),r("div",{staticClass:"btn submit",class:{disabled:!e.hasSelectedVideo},on:{click:function(n){return e.useSelectedVideo()}}},[e._v(" "+e._s(e.t("videos","Select"))+" ")])])])},hr=[],mr=c(vr,pr,hr,!1,null,null,null,null);const _r=mr.exports;const h=window.Vue;h.config.productionTip=!1;h.mixin(W);window.VideoExplorerConstructor=h.extend({render:t=>t(Jt),store:H()});window.VideoFieldConstructor=h.extend({created(){this.$store=H()},render:t=>t(ur)});window.VideoSelectorActionsConstructor=h.extend({render:t=>t(_r)});window.VideoPlayerConstructor=h.extend({render:t=>t(er)});
//# sourceMappingURL=main-4e781037.js.map
