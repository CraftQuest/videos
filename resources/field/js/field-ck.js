console.log("field.js");var dkvideos={};dkvideos.currentVideo=!1;dkvideos.currentField=!1;dkvideos.preview={init:function(){console.log("mcp.preview.init()");$(".dkv-player .cancel").click(function(){dkvideos.preview.hide();return!1});$(".dkv-player .submit").click(function(){dkvideos.preview.hide();dkvideos.modal.hide();console.log("submit");$("input.text",dkvideos.currentField).attr("value",dkvideos.currentVideo.url);dkvideos.field.preview(dkvideos.currentVideo.url,dkvideos.currentField);return!1})},play:function(e){dkvideos.currentVideo=e;dkvideos.preview.show()},resize:function(){var e=$(".dkv-modal").outerHeight(),t=$(".dkv-modal").outerWidth(),n=$(".dkv-modal .modal-bottom").outerHeight(),r=e-n,i=r-$(".dkv-player .dkv-bottom").outerHeight();$(".dkv-player").css("height",r);$(".dkv-player .dkv-embed").css("height",i)},show:function(){$(".dkv-player").css("display","block");dkvideos.preview.resize()},hide:function(){$(".dkv-player .dkv-embed").html("");$(".dkv-player").css("display","none")}};dkvideos.field={};dkvideos.field.preview=function(e,t){Craft.postActionRequest("videos/ajax/fieldEmbed",{videoUrl:e},function(n){console.log("fieldEmbed",e);var r=$(".dkv-preview",t);r.html("");r.css("display","block");$(n.embed).appendTo(r);dkvideos.preview.init();$(".add",t).css("display","none");$(".change",t).css("display","inline-block");$(".remove",t).css("display","inline-block")})};dkvideos.modal={init:function(){console.log("dkvideos.modal.init()");overlay=$('<div class="dkv-overlay"></div>');overlay.appendTo("body");overlay.click(function(){dkvideos.modal.hide()})},resize:function(){var e=$(window).height(),t=$(window).width(),n=$(".dkv-modal").outerHeight(),r=$(".dkv-modal").outerWidth(),i=(e-n)/2,s=(t-r)/2;$(".dkv-modal").css("top",i);$(".dkv-modal").css("left",s);var o=$(".dkv-modal .modal-bottom").outerHeight(),u=n-o-40;$(".dv-box").css("height",u);var a=n-80;$(".dkv-videos-wrap").css("height",a)},show:function(){$(".dkv-overlay").css("display","block");$(".dkv-modal").css("display","block");dkvideos.modal.resize()},hide:function(){$(".dkv-overlay").css("display","none");$(".dkv-modal").css("display","none");dkvideos.preview.hide()}};console.log("hello modal");dkvideos.scroll={init:function(){$(".dkv-videos-wrap").scroll(function(){$(".dkv-videos-wrap").scrollTop()+$(".dkv-videos-wrap").height()>=$(document).height()&&$(".dkv-video-more").css("display")!="none"&&$(".dkv-video-more a").trigger("click")})}};(function(e){e.fn.dukt_videos_field=function(t){return this.each(function(){field=e(this);e.fn.dukt_videos_field.init_field(field)})};e.fn.dukt_videos_field.init=function(){console.log("hello",videos);dkvideos.modal.init();Craft.postActionRequest("videos/ajax/modal",{},function(t){e(t).appendTo("body");dkvideos.preview.init();console.log("angular bootstrap");angular.bootstrap(e(".dkv-modal"),["videos"])})};e.fn.dukt_videos_field.init_field=function(t){var n=e("input.text",t),r=n.val();if(r!=="")dkvideos.field.preview(r,t);else{e(".add",t).css("display","inline-block");e(".change",t).css("display","none");e(".remove",t).css("display","none")}e(".add, .change",t).click(function(){dkvideos.currentField=t;dkvideos.modal.show()});e(".remove",t).click(function(){n.val("");e(".dkv-preview",t).css("display","none");e(".dkv-preview",t).html();e(".add",t).css("display","inline-block");e(".change",t).css("display","none");e(".remove",t).css("display","none")})};e(document).ready(function(){e.fn.dukt_videos_field.init()})})(jQuery);$(document).ready(function(){console.log("Videos field on this page : ",$(".dkv-field").length);$(".dkv-field").dukt_videos_field()});$(window).resize(function(){dkvideos.preview.resize();dkvideos.modal.resize()});