function ServicesListCtrl($scope,$routeParams,$http,$rootScope,$location,DuktVideosService){console.log("!!controller");console.log("!!rootScope.testService");console.log("!!--------------------------------");$scope.serviceKey=$routeParams.serviceKey;$scope.methodName=$routeParams.methodName;$scope.playlistId=$routeParams.playlistId;console.log("$scope.playlistId",$scope.playlistId);typeof $rootScope.services!="undefined"&&($scope.currentService=$rootScope.services[$scope.serviceKey]);console.log("-----",$rootScope.services);DuktVideosService.services="yeah";$scope.videos=eval("$rootScope."+$scope.serviceKey+"_videos");$scope.getClass=function(e){var t=new RegExp("/.*/"+e),n=$location.path().match(t);return n?"active":""};if($scope.serviceKey&&$scope.methodName){setTimeout(function(){$scope.search(!0)},100);var opts={method:$scope.methodName,service:$scope.serviceKey,playlistId:$scope.playlistId};$(".dv-main .toolbar .spinner").removeClass("hidden");$http({method:"POST",url:Craft.getActionUrl("duktvideos/ajax/angular",opts),cache:!0}).success(function(e,t,n,r){console.log("success",e);$scope.videos=e;$scope.videos.length==0;if(e.length<Dukt_videos.pagination_per_page){console.log("display none");$(".dv-video-more").css("display","none")}else $(".dv-video-more").css("display","block");$(".dv-main .toolbar .spinner").addClass("hidden")}).error(function(e,t,n,r){console.log("error",e,t,n,r)})}$scope.serviceChange=function(){$location.path($scope.serviceKey+"/"+$scope.methodName);console.log($scope.methodName);$scope.getClass($scope.methodName)};$scope.searchQuery=DuktVideosService.searchQuery;var searchTimer=!1;$scope.search=function(e){typeof e=="undefined"&&(e=!1);console.log("launch search");if(DuktVideosService.searchQuery!=$scope.searchQuery||e==1){DuktVideosService.searchQuery=$scope.searchQuery;clearTimeout(searchTimer);searchTimer=setTimeout(function(){console.log(DuktVideosService.searchQuery);var e={method:$scope.methodName,service:$scope.serviceKey,searchQuery:DuktVideosService.searchQuery};$(".dv-main .toolbar .spinner").removeClass("hidden")},500)}};$scope.play=function(e){$("#player").css("visibility","visible");$("#player-overlay").css("visibility","visible");$scope.selected=e;loadVideo(e.id);console.log("play video",e.id)};$scope.isSelected=function(e){return $scope.selected===e};$scope.moreVideos=function(){var e=$scope.videos.length;$(".dv-video-more").css("display","none");var t={method:$scope.methodName,service:$scope.serviceKey,searchQuery:DuktVideosService.searchQuery,offset:e};$http({method:"POST",url:Craft.getActionUrl("duktvideos/ajax/angular",t),cache:!0}).success(function(e,t,n,r){console.log("xxxxsuccess",e);console.log("-----success",e.length);$.merge($scope.videos,e);$scope.videos.length==0;console.log("success",e.length);if(e.length<Dukt_videos.pagination_per_page){console.log("display none");$(".dv-video-more").css("display","none")}else $(".dv-video-more").css("display","block");$(".dv-main .toolbar .spinner").addClass("hidden")}).error(function(e,t,n,r){console.log("error",e,t,n,r)})}};